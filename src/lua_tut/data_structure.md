# 数据结构


Lua 中的表，不属于某种数据结构，而 *就* 是数据结构本身，tables in Lua are not a data structure; they are *the* data structure。以 Lua 中的表，咱们可以表示其他语言所提供的全部结构 -- 数组 arrays、记录 records、列表 lists、队列 queues、集合 sets 等等。此外，Lua 表还能高效地实现，全部这些结构。


在 C 和 Pascal 等传统语言中，我们会以数组和列表（列表 = 记录 + 指针），来实现大多数数据结构。虽然我们可以使用 Lua 表，来实现数组和列表（有时我们也这样做），但表要比数组和列表更强大；使用表后，许多算法都简化到了微不足道的地步。例如，我们很少在 Lua 中编写某种搜索，因为表提供了对任何类型的直接访问。


掌握如何高效地使用表，需要一点时间。本章，我们将介绍如何使用表，实现一些典型的数据结构，并举例说明其用途。我们将从数组和列表开始，这并非因为其他结构需要他们，而是因为大多数程序员已经熟悉他们。(我们已经在第 5 章 [*表*](tables.md) 中，了解了这方面的基础知识，但为了完整起见，我（作者）还是在此重复一遍。）随后，我们将继续一些更高级的示例，如集合 sets、包 bags 以及图 graphs。


## 数组

我们中简单地通过用整数索引表，来实现 Lua 中的数组。因此，数组没有固定的大小，而是根据需要增长。通常，当我们初始化数组时，我们间接地定义了其大小。例如，在以下代码之后，任何访问 1-1000 范围之外字段的尝试,都将返回 `nil`，而不是零：

```lua
local a = {}                    -- 新建数组
for i = 1, 1000 do
    a[i] = 0
end

print(#a, a[#a], a[#a + 5])     --> 1000    0       nil
```

长度运算符 (`#`) 就运用这一事实，来查找数组的大小：


```lua
print(#a)           --> 1000
```

我们可以从索引零、一或任何其他值，开始某个数组：


```lua
-- 创建一个索引为 -5 到 5 的数组
a = {}
for i = -5, 5 do
    a[i] = 0
end
```

然而，Lua 中习惯以索引一，开始数组。 Lua 库遵循了这个惯例；长度运算符也是如此。如果咱们的数组不以一开头，我们将无法使用这些设施。


我们可以使用构造器，a constructor，在单个表达式中，创建并初始化某个数组：

```lua
squares = {1, 4, 9, 16, 25, 36, 49, 64, 81}
```

这样的构造器可以很大，可以根据需要设置很多元素。在 Lua 中，有着数百万元素的数据描述文件，并不少见。


## 矩阵与多维数组

Lua 中表示矩阵的主要方法有两种。第一种是 *交错数组，jagged array*（数组的数组），即一个表，其中每个元素均为另一个表。例如，咱们可以使用以下代码，创建出维度为 **N** × **M** 的一个零的矩阵：
